import{b as M,e as S,o as r,a as o,f as s,h as k,w as N,F as v,i as y,j as x,k as $,l as g,t as h,m as C,v as I,p as j,q as B}from"./swiper-vue.520d28f9.js";import{c as V,M as E,u as A,r as b,m as L,a as U,e as F}from"./MyInput.74164eff.js";import{M as P}from"./MyButton.1f5d35d1.js";import{u as T,a as q}from"./modal.924e5f6a.js";import{u as K,a as X}from"./orders.072a741d.js";import{u as z}from"./entry.6922467d.js";import{_ as R}from"./_plugin-vue_export-helper.c27b6911.js";const Y=V.regex(/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/),G={name:"CheckOut",components:{MyButton:P,MyInput:E},data(){return{userData:{userName:{name:"name",type:"text",value:""},surname:{name:"surname",type:"text",value:""},email:{name:"email",type:"email",value:""},phone:{name:"phone",type:"text",value:""}},loading:!1,isActiveCheckout:!1,blocks:[{title:"Delivery",type:"delivery",options:[{label:"pickup",value:"pickup"},{label:"delivery by our company",value:"company"},{label:"delivery by FedEX",value:"FedEX"}],selected:"pickup"},{title:"Payment",type:"payment",options:[{label:"bank transfer",value:"bank transfer"},{label:"cash payment",value:"cash payment"},{label:"credit",value:"credit"},{label:"leasing",value:"leasing"}],selected:"bank transfer"}],order:{customer:{userName:"",surname:"",email:"",phone:"",deliveryOrder:"",paymentOrder:""},orderId:null,orderProducts:[]}}},setup(){const t=A(),n=K(),c=M(()=>n.getUserData),l=z(),a=X(),d=T(),_=q(),f=a.orders,e=d.cartList,u=_.modalTexts;return{userStore:n,getUserData:c,authStore:l,orders:f,ordersStore:a,cartList:e,cartListStore:d,modalTexts:u,modalStore:_,v$:t}},validations(){return{userData:{userName:{value:{required:b,minLength:L(2),maxLength:U(20)}},surname:{value:{required:b,minLength:L(2),maxLength:U(20)}},email:{value:{required:b,email:F}},phone:{value:{required:b,number:V.withMessage("This is not phone",Y)}}}}},methods:{handleSubmitOrder(){if(!this.authStore.isUserAuthed)this.authStore.openAuthModal();else{if(this.loading)return;this.loading=!0,this.order.customer.userName=this.userData.userName,this.order.customer.surname=this.userData.surname,this.order.customer.email=this.userData.email,this.order.customer.phone=this.userData.phone,this.order.customer.deliveryOrder=this.blocks[0].selected,this.order.customer.paymentOrder=this.blocks[1].selected,this.order.orderId=Date.now(),this.order.orderProducts=this.cartList;try{this.ordersStore.addNewOrder(this.order),this.cartListStore.clearCartList(),this.modalStore.openVoiceModal("your order has been placed and sent for processing, we will contact you"),this.$router.go(-1)}catch(t){console.log(t)}finally{this.loading=!1}}}},mounted(){const t=Object.keys(this.getUserData),n=Object.keys(this.userData);t.forEach(c=>{if(n.includes(c)){const l=this.getUserData[c].value;l&&(this.userData[c].value=l)}})}},w=t=>(j("data-v-bc85e45c"),t=t(),B(),t),H={class:"checkOut"},J={class:"checkOut__wrapper"},Q=w(()=>s("h1",{class:"checkOut__title center"},"Placing an orders",-1)),W={class:"checkOut__block"},Z=w(()=>s("h3",{class:"checkOut__form_subtitle"},"1 Your contact details",-1)),ee={class:"checkOut__form_grid"},te=["for"],se={class:"checkOut__form_subtitle"},ae=["onUpdate:modelValue","value"];function re(t,n,c,l,a,d){const _=S("my-input"),f=S("my-button");return r(),o("div",H,[s("div",J,[Q,s("form",{class:k(["checkOut__form form",{disabled_class:a.loading}]),onSubmit:n[0]||(n[0]=N((...e)=>d.handleSubmitOrder&&d.handleSubmitOrder(...e),["prevent"]))},[s("div",W,[Z,s("div",ee,[(r(!0),o(v,null,y(Object.values(a.userData),(e,u)=>{var i,p;return r(),o("div",{key:u,class:k(`checkOut__form_grid_${e.name}`)},[s("label",{for:`input_${e.name}`},[g(h(e.name)+" ",1),x(_,{modelValue:e.value,"onUpdate:modelValue":m=>e.value=m,class:"checkOut__form_input input",name:`input_${e.name}`,onBlur:m=>{var O,D;return(D=(O=l.v$)==null?void 0:O.userData[Object.keys(a.userData)[u]])==null?void 0:D.$touch()}},null,8,["modelValue","onUpdate:modelValue","name","onBlur"])],8,te),(r(!0),o(v,null,y((p=(i=l.v$)==null?void 0:i.userData[Object.keys(a.userData)[u]])==null?void 0:p.$errors,m=>(r(),o("p",{key:m.$uid,class:"messageError checkOut__message-error"},h(m.$message),1))),128))],2)}),128))])]),(r(!0),o(v,null,y(a.blocks,(e,u)=>(r(),o("div",{key:u,class:"checkOut__block"},[s("h3",se,h(u+2)+" "+h(e.title),1),s("div",{class:k(`checkOut__form_${e.type}`)},[(r(!0),o(v,null,y(e.options,i=>(r(),o("label",{key:i.value},[C(s("input",{"onUpdate:modelValue":p=>e.selected=p,type:"radio",value:i.value,class:"checkOut__form_radio"},null,8,ae),[[I,e.selected]]),g(" "+h(i.label),1)]))),128))],2)]))),128)),x(f,{type:"submit",class:"checkOut__form_btn btn",disabled:a.loading},{default:$(()=>[g(" Submit order ")]),_:1},8,["disabled"])],34)])])}const me=R(G,[["render",re],["__scopeId","data-v-bc85e45c"]]);export{me as default};
